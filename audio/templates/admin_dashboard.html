{% extends "layout.html" %}
{% block title %}Admin Dashboard | Sound Remover{% endblock %}
{% block content %}
<div class="container py-4">
  <h2 class="fw-bold mb-3">üßæ Admin Dashboard ‚Äî ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h2>

  {% if payments %}
  <table class="table table-dark table-striped align-middle">
    <thead>
      <tr>
        <th>‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</th>
        <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</th>
        <th>‡∏ß‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡πÇ‡∏≠‡∏ô</th>
        <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
        <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ôTicket</th>
        <th>‡∏™‡∏•‡∏¥‡∏õ</th>
        <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á</th>
        <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
      </tr>
    </thead>
    <tbody>
      {% for p in payments %}
      <tr>
        <td>{{ p.user.username }}</td>
        <td>{{ p.amount }} ‡∏ö‡∏≤‡∏ó</td>
        <td>{{ p.transfer_datetime|date:"d/m/Y H:i" }}</td>
        <td>
          {% if p.status == "approved" %}
          <span class="badge bg-success">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß</span>
          {% elif p.status == "rejected" %}
          <span class="badge bg-danger">‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò</span>
          {% else %}
          <span class="badge bg-warning text-dark">‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</span>
          {% endif %}
        </td>
        <td>
          {{ p.user.userprofile.tickets }}
        </td>
        <td>
          <a href="{{ p.slip_image.url }}" target="_blank" class="btn btn-sm btn-outline-info">
            ‡∏î‡∏π‡∏™‡∏•‡∏¥‡∏õ
          </a>
        </td>
        <td>{{ p.created_at|date:"d/m/Y H:i" }}</td>

        <!-- ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏∏‡πà‡∏° Approve / Reject -->
        <td>
          {% if p.status == "pending" %}
          <form method="post" action="{% url 'approve_payment' p.id %}" class="d-inline">
            {% csrf_token %}
            <button type="submit" class="btn btn-sm btn-success"
              onclick="return confirm('‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')">Approve</button>
          </form>
          <form method="post" action="{% url 'reject_payment' p.id %}" class="d-inline">
            {% csrf_token %}
            <button type="submit" class="btn btn-sm btn-danger"
              onclick="return confirm('üö´ ‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')">Reject</button>
          </form>
          {% else %}
          <span class="text-muted small">‚Äî</span>
          {% endif %}
        </td>
      </tr>
      {% endfor %}
    </tbody>

  </table>
  {% else %}
  <p class="text-muted">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</p>
  {% endif %}
</div>
{% endblock %}